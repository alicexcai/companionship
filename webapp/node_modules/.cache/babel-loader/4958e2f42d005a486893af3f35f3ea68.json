{"ast":null,"code":"var _jsxFileName = \"/Users/alicecai/Desktop/gpt3-chat/src/components/MessageList/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Compose from \"../Compose\";\nimport Message from \"../Message\";\nimport \"./MessageList.css\";\nimport Toolbar from \"../Toolbar\";\nimport GPTService from \"../../services/gpt\";\nimport MessageBuilderService from \"../../services/message-builder\";\nimport TypingIndicator from \"../TypingIndicator\";\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MY_USER_ID = \"Patient\";\nexport default function MessageList() {\n  _s();\n\n  const options = ['Intellectual Conversation', 'Theraputic Conversation', 'Reflective Conversation', 'Problem-solving Conversation', 'Open-ended Conversation'];\n  const defaultOption = options[0];\n  const [option, setOption] = useState(defaultOption); // const conversationDict = [\n  //   {id: \"Intellectual Conversation\", character: \"Professor\"},\n  //   {id: \"Theraputic Conversation\", character: \"Therapist\"},\n  //   {id: \"Reflective Conversation\", character: \"Self\"},\n  //   {id: \"Problem-solving Conversation\", character: \"Counselor\"},\n  //   {id: \"Open-ended Conversation\", character: \"Friend\"},\n  // ]\n\n  let speakerDict = new Map();\n  speakerDict.set(\"Intellectual Conversation\", {\n    speaker: \"Professor\",\n    message: \"Hello, I am a professor. Let's talk about something interesting. What is the most fascinating concept you've learned about lately?\"\n  });\n  speakerDict.set(\"Theraputic Conversation\", {\n    speaker: \"Therapist\",\n    message: \"Hello, I am a therapist. I am here to help you with your mental health. How do you feel?\"\n  });\n  speakerDict.set(\"Reflective Conversation\", {\n    speaker: \"Self\",\n    message: \"Hello, I am you, yourself. I am here to help you reflect on your life. What's new in your life?\"\n  });\n  speakerDict.set(\"Problem-solving Conversation\", {\n    speaker: \"Counselor\",\n    message: \"Hello, I am a counselor. I am here to help you solve any problems you may have. What is one thing you're struggling with right now?\"\n  });\n  speakerDict.set(\"Open-ended Conversation\", {\n    speaker: \"Friend\",\n    message: \"Hello, I am your friend. I'm here to talk about something fun!\"\n  });\n\n  const handleOptionChange = option => {\n    setOption(option.value);\n    console.log(\"Option: \", option);\n    setMessages([{\n      author: speakerDict.get(option).speaker,\n      message: speakerDict.get(option).message,\n      timestamp: new Date().getTime()\n    }]);\n    console.log(\"Conversation info: \", messages);\n  };\n\n  const [loading, setLoading] = useState(false);\n  const [messages, setMessages] = useState([{\n    author: speakerDict.get(option).speaker,\n    message: speakerDict.get(option).message,\n    timestamp: new Date().getTime()\n  }]); // Stays scrolled to bottom.\n\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    if (messagesEndRef) {\n      var _messagesEndRef$curre;\n\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    }\n  });\n\n  const addMyMessage = async value => {\n    const newMessage = {\n      author: MY_USER_ID,\n      message: value,\n      timestamp: new Date().getTime()\n    };\n    setMessages(previous => [...previous, newMessage]);\n    setLoading(true);\n    const withMine = [...messages, newMessage];\n    const response = await GPTService.getAIResponse(withMine);\n    const responseMessage = {\n      author: \"Therapist\",\n      message: response,\n      timestamp: new Date().getTime()\n    };\n    setMessages(previous => [...previous, responseMessage]);\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"message-list\",\n    children: [/*#__PURE__*/_jsxDEV(Toolbar, {\n      title: \"Chat with GPT3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"What kind of conversation do you want to have?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n      options: options,\n      onChange: e => handleOptionChange(e),\n      value: defaultOption,\n      placeholder: \"Select conversation type\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message-list-container\",\n      children: [MessageBuilderService.getMessages(messages, MY_USER_ID), loading && /*#__PURE__*/_jsxDEV(TypingIndicator, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 106,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Compose, {\n      addMessage: addMyMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MessageList, \"tXdC+Nlsz0QYe1EnfRmkkARWjN0=\");\n\n_c = MessageList;\n\nvar _c;\n\n$RefreshReg$(_c, \"MessageList\");","map":{"version":3,"sources":["/Users/alicecai/Desktop/gpt3-chat/src/components/MessageList/index.tsx"],"names":["React","useEffect","useRef","useState","Compose","Message","Toolbar","GPTService","MessageBuilderService","TypingIndicator","Dropdown","MY_USER_ID","MessageList","options","defaultOption","option","setOption","speakerDict","Map","set","speaker","message","handleOptionChange","value","console","log","setMessages","author","get","timestamp","Date","getTime","messages","loading","setLoading","messagesEndRef","current","scrollIntoView","behavior","addMyMessage","newMessage","previous","withMine","response","getAIResponse","responseMessage","e","getMessages"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,MAA3B,EAAmCC,QAAnC,QAAmD,OAAnD;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,YAApB;AAGA,OAAO,mBAAP;AACA,OAAOC,OAAP,MAAoB,YAApB;AACA,OAAOC,UAAP,MAAuB,oBAAvB;AACA,OAAOC,qBAAP,MAAkC,gCAAlC;AACA,OAAOC,eAAP,MAA4B,oBAA5B;AAEA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAO,0BAAP;;AAEA,MAAMC,UAAU,GAAG,SAAnB;AAOA,eAAe,SAASC,WAAT,GAAuB;AAAA;;AAEpC,QAAMC,OAAO,GAAG,CACd,2BADc,EAEd,yBAFc,EAGd,yBAHc,EAId,8BAJc,EAKd,yBALc,CAAhB;AAOA,QAAMC,aAAa,GAAGD,OAAO,CAAC,CAAD,CAA7B;AACA,QAAM,CAACE,MAAD,EAASC,SAAT,IAAsBb,QAAQ,CAACW,aAAD,CAApC,CAVoC,CAYpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEE,MAAIG,WAAW,GAAG,IAAIC,GAAJ,EAAlB;AACAD,EAAAA,WAAW,CAACE,GAAZ,CAAgB,2BAAhB,EAA6C;AAAEC,IAAAA,OAAO,EAAE,WAAX;AAAwBC,IAAAA,OAAO,EAAE;AAAjC,GAA7C;AACAJ,EAAAA,WAAW,CAACE,GAAZ,CAAgB,yBAAhB,EAA2C;AAAEC,IAAAA,OAAO,EAAE,WAAX;AAAwBC,IAAAA,OAAO,EAAE;AAAjC,GAA3C;AACAJ,EAAAA,WAAW,CAACE,GAAZ,CAAgB,yBAAhB,EAA2C;AAAEC,IAAAA,OAAO,EAAE,MAAX;AAAmBC,IAAAA,OAAO,EAAE;AAA5B,GAA3C;AACAJ,EAAAA,WAAW,CAACE,GAAZ,CAAgB,8BAAhB,EAAgD;AAAEC,IAAAA,OAAO,EAAE,WAAX;AAAwBC,IAAAA,OAAO,EAAE;AAAjC,GAAhD;AACAJ,EAAAA,WAAW,CAACE,GAAZ,CAAgB,yBAAhB,EAA2C;AAAEC,IAAAA,OAAO,EAAE,QAAX;AAAqBC,IAAAA,OAAO,EAAE;AAA9B,GAA3C;;AAGF,QAAMC,kBAAkB,GAAIP,MAAD,IAAoB;AAC7CC,IAAAA,SAAS,CAACD,MAAM,CAACQ,KAAR,CAAT;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ,EAAwBV,MAAxB;AAAiCW,IAAAA,WAAW,CAAC,CAC3C;AACEC,MAAAA,MAAM,EAAEV,WAAW,CAACW,GAAZ,CAAgBb,MAAhB,EAAyBK,OADnC;AAEEC,MAAAA,OAAO,EAAEJ,WAAW,CAACW,GAAZ,CAAgBb,MAAhB,EAAyBM,OAFpC;AAGEQ,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX;AAHb,KAD2C,CAAD,CAAX;AAOjCP,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCO,QAAnC;AACD,GAVD;;AAYA,QAAM,CAACC,OAAD,EAAUC,UAAV,IAAwB/B,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM,CAAC6B,QAAD,EAAWN,WAAX,IAA0BvB,QAAQ,CAAC,CACvC;AACEwB,IAAAA,MAAM,EAAEV,WAAW,CAACW,GAAZ,CAAgBb,MAAhB,EAAyBK,OADnC;AAEEC,IAAAA,OAAO,EAAEJ,WAAW,CAACW,GAAZ,CAAgBb,MAAhB,EAAyBM,OAFpC;AAGEQ,IAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX;AAHb,GADuC,CAAD,CAAxC,CAzCoC,CAiDpC;;AACA,QAAMI,cAAc,GAAGjC,MAAM,CAAC,IAAD,CAA7B;AACAD,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIkC,cAAJ,EAAoB;AAAA;;AAClB,+BAACA,cAAc,CAACC,OAAhB,gFAAiCC,cAAjC,CAAgD;AAAEC,QAAAA,QAAQ,EAAE;AAAZ,OAAhD;AACD;AACF,GAJQ,CAAT;;AAKA,QAAMC,YAAY,GAAG,MAAOhB,KAAP,IAAyB;AAC5C,UAAMiB,UAAU,GAAG;AACjBb,MAAAA,MAAM,EAAEhB,UADS;AAEjBU,MAAAA,OAAO,EAAEE,KAFQ;AAGjBM,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX;AAHM,KAAnB;AAMAL,IAAAA,WAAW,CAAEe,QAAD,IAAc,CAAC,GAAGA,QAAJ,EAAcD,UAAd,CAAf,CAAX;AACAN,IAAAA,UAAU,CAAC,IAAD,CAAV;AACA,UAAMQ,QAAQ,GAAG,CAAC,GAAGV,QAAJ,EAAcQ,UAAd,CAAjB;AACA,UAAMG,QAAQ,GAAG,MAAMpC,UAAU,CAACqC,aAAX,CAAyBF,QAAzB,CAAvB;AACA,UAAMG,eAAe,GAAG;AACtBlB,MAAAA,MAAM,EAAE,WADc;AAEtBN,MAAAA,OAAO,EAAEsB,QAFa;AAGtBd,MAAAA,SAAS,EAAE,IAAIC,IAAJ,GAAWC,OAAX;AAHW,KAAxB;AAKAL,IAAAA,WAAW,CAAEe,QAAD,IAAc,CAAC,GAAGA,QAAJ,EAAcI,eAAd,CAAf,CAAX;AACAX,IAAAA,UAAU,CAAC,KAAD,CAAV;AACD,GAlBD;;AAoBA,sBACE;AAAK,IAAA,SAAS,EAAC,cAAf;AAAA,4BACE,QAAC,OAAD;AAAS,MAAA,KAAK,EAAC;AAAf;AAAA;AAAA;AAAA;AAAA,YADF,eAGE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAHF,eAIE,QAAC,QAAD;AAAU,MAAA,OAAO,EAAErB,OAAnB;AAA4B,MAAA,QAAQ,EAAGiC,CAAD,IAAOxB,kBAAkB,CAACwB,CAAD,CAA/D;AAAoE,MAAA,KAAK,EAAEhC,aAA3E;AAA0F,MAAA,WAAW,EAAC;AAAtG;AAAA;AAAA;AAAA;AAAA,YAJF,eAME;AAAK,MAAA,SAAS,EAAC,wBAAf;AAAA,iBAAyCN,qBAAqB,CAACuC,WAAtB,CAAkCf,QAAlC,EAA4CrB,UAA5C,CAAzC,EACCsB,OAAO,iBAAI,QAAC,eAAD;AAAA;AAAA;AAAA;AAAA,cADZ,eAEA;AAAK,QAAA,GAAG,EAAEE;AAAV;AAAA;AAAA;AAAA;AAAA,cAFA;AAAA;AAAA;AAAA;AAAA;AAAA,YANF,eAYE,QAAC,OAAD;AAAS,MAAA,UAAU,EAAEI;AAArB;AAAA;AAAA;AAAA;AAAA,YAZF;AAAA;AAAA;AAAA;AAAA;AAAA,UADF;AAgBD;;GA5FuB3B,W;;KAAAA,W","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Compose from \"../Compose\";\nimport Message from \"../Message\";\nimport moment from \"moment\";\n\nimport \"./MessageList.css\";\nimport Toolbar from \"../Toolbar\";\nimport GPTService from \"../../services/gpt\";\nimport MessageBuilderService from \"../../services/message-builder\";\nimport TypingIndicator from \"../TypingIndicator\";\n\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\n\nconst MY_USER_ID = \"Patient\";\n\nexport interface Message {\n  author: string;\n  message: string;\n  timestamp: number;\n}\nexport default function MessageList() {\n\n  const options = [\n    'Intellectual Conversation',\n    'Theraputic Conversation',\n    'Reflective Conversation',\n    'Problem-solving Conversation',\n    'Open-ended Conversation'\n  ];\n  const defaultOption = options[0];\n  const [option, setOption] = useState(defaultOption);\n\n  // const conversationDict = [\n  //   {id: \"Intellectual Conversation\", character: \"Professor\"},\n  //   {id: \"Theraputic Conversation\", character: \"Therapist\"},\n  //   {id: \"Reflective Conversation\", character: \"Self\"},\n  //   {id: \"Problem-solving Conversation\", character: \"Counselor\"},\n  //   {id: \"Open-ended Conversation\", character: \"Friend\"},\n  // ]\n    type Conversation = { speaker: string, message: string };\n    let speakerDict = new Map<string, Conversation>();\n    speakerDict.set(\"Intellectual Conversation\", { speaker: \"Professor\", message: \"Hello, I am a professor. Let's talk about something interesting. What is the most fascinating concept you've learned about lately?\" });\n    speakerDict.set(\"Theraputic Conversation\", { speaker: \"Therapist\", message: \"Hello, I am a therapist. I am here to help you with your mental health. How do you feel?\" });\n    speakerDict.set(\"Reflective Conversation\", { speaker: \"Self\", message: \"Hello, I am you, yourself. I am here to help you reflect on your life. What's new in your life?\" });\n    speakerDict.set(\"Problem-solving Conversation\", { speaker: \"Counselor\", message: \"Hello, I am a counselor. I am here to help you solve any problems you may have. What is one thing you're struggling with right now?\" });\n    speakerDict.set(\"Open-ended Conversation\", { speaker: \"Friend\", message: \"Hello, I am your friend. I'm here to talk about something fun!\" });\n\n\n  const handleOptionChange = (option: string) => {\n    setOption(option.value);\n    console.log(\"Option: \", option); setMessages([\n      {\n        author: speakerDict.get(option)!.speaker,\n        message: speakerDict.get(option)!.message,\n        timestamp: new Date().getTime(),\n      },\n    ]);\n    console.log(\"Conversation info: \", messages)\n  };\n\n  const [loading, setLoading] = useState(false);\n  const [messages, setMessages] = useState([\n    {\n      author: speakerDict.get(option)!.speaker,\n      message: speakerDict.get(option)!.message,\n      timestamp: new Date().getTime(),\n    },\n  ] as Message[]);\n\n  // Stays scrolled to bottom.\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    if (messagesEndRef) {\n      (messagesEndRef.current as any)?.scrollIntoView({ behavior: \"smooth\" })\n    }\n  });\n  const addMyMessage = async (value: string) => {\n    const newMessage = {\n      author: MY_USER_ID,\n      message: value,\n      timestamp: new Date().getTime(),\n    };\n    \n    setMessages((previous) => [...previous, newMessage]);\n    setLoading(true);\n    const withMine = [...messages, newMessage];\n    const response = await GPTService.getAIResponse(withMine);\n    const responseMessage = {\n      author: \"Therapist\",\n      message: response,\n      timestamp: new Date().getTime(),\n    };\n    setMessages((previous) => [...previous, responseMessage]);\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"message-list\">\n      <Toolbar title=\"Chat with GPT3\" />\n      {/* <Dropdown title=\"Select conversatio type\" /> */}\n      <h4>What kind of conversation do you want to have?</h4>\n      <Dropdown options={options} onChange={(e) => handleOptionChange(e)} value={defaultOption} placeholder=\"Select conversation type\" />\n\n      <div className=\"message-list-container\">{MessageBuilderService.getMessages(messages, MY_USER_ID)}\n      {loading && <TypingIndicator />}\n      <div ref={messagesEndRef} />\n      </div>\n      \n\n      <Compose addMessage={addMyMessage} />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}