{"ast":null,"code":"var _jsxFileName = \"/Users/alicecai/Desktop/gpt3-chat/src/components/MessageList/index.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Compose from \"../Compose\";\nimport Message from \"../Message\";\nimport \"./MessageList.css\";\nimport Toolbar from \"../Toolbar\";\nimport GPTService from \"../../services/gpt\";\nimport MessageBuilderService from \"../../services/message-builder\";\nimport TypingIndicator from \"../TypingIndicator\";\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst MY_USER_ID = \"Patient\";\nexport default function MessageList() {\n  _s();\n\n  const options = ['Intellectual Conversation', 'Theraputic Conversation', 'Reflective Conversation', 'Problem-solving Conversation', 'Open-ended Conversation'];\n  const defaultOption = options[0];\n  const [option, setOption] = useState(defaultOption); // const conversationDict = [\n  //   {id: \"Intellectual Conversation\", character: \"Professor\"},\n  //   {id: \"Theraputic Conversation\", character: \"Therapist\"},\n  //   {id: \"Reflective Conversation\", character: \"Self\"},\n  //   {id: \"Problem-solving Conversation\", character: \"Counselor\"},\n  //   {id: \"Open-ended Conversation\", character: \"Friend\"},\n  // ]\n\n  let speakerDict = new Map();\n  speakerDict.set(\"Intellectual Conversation\", [\"Professor\", \"Professor1\"]);\n  speakerDict.set(\"Theraputic Conversation\", [\"Therapist\", \"Therapist1\"]);\n  speakerDict.set(\"Reflective Conversation\", [\"Self\", \"Self1\"]);\n  speakerDict.set(\"Problem-solving Conversation\", [\"Counselor\", \"Counselor1\"]);\n  speakerDict.set(\"Open-ended Conversation\", [\"Friend\", \"Friend1\"]);\n  const [loading, setLoading] = useState(false);\n  const [messages, setMessages] = useState([{\n    author: speakerDict.get(option)[0],\n    message: \"Hi friend! I'm your virtual therapist. How are you feeling today?\",\n    timestamp: new Date().getTime()\n  }]); // Stays scrolled to bottom.\n\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    if (messagesEndRef) {\n      var _messagesEndRef$curre;\n\n      (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    }\n  });\n\n  const addMyMessage = async value => {\n    const newMessage = {\n      author: MY_USER_ID,\n      message: value,\n      timestamp: new Date().getTime()\n    };\n    setMessages(previous => [...previous, newMessage]);\n    setLoading(true);\n    const withMine = [...messages, newMessage];\n    const response = await GPTService.getAIResponse(withMine);\n    const responseMessage = {\n      author: \"Therapist\",\n      message: response,\n      timestamp: new Date().getTime()\n    };\n    setMessages(previous => [...previous, responseMessage]);\n    setLoading(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"message-list\",\n    children: [/*#__PURE__*/_jsxDEV(Toolbar, {\n      title: \"Chat with GPT3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n      children: \"What kind of conversation do you want to have?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Dropdown, {\n      options: options,\n      onChange: e => {\n        setOption(e.value);\n        console.log(option);\n      },\n      value: defaultOption,\n      placeholder: \"Select conversation type\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"message-list-container\",\n      children: [MessageBuilderService.getMessages(messages, MY_USER_ID), loading && /*#__PURE__*/_jsxDEV(TypingIndicator, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 19\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: messagesEndRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Compose, {\n      addMessage: addMyMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n}\n\n_s(MessageList, \"gU5bsqSN/9/20eCaSatINQjfjsc=\");\n\n_c = MessageList;\n\nvar _c;\n\n$RefreshReg$(_c, \"MessageList\");","map":{"version":3,"sources":["/Users/alicecai/Desktop/gpt3-chat/src/components/MessageList/index.tsx"],"names":["React","useEffect","useRef","useState","Compose","Message","Toolbar","GPTService","MessageBuilderService","TypingIndicator","Dropdown","MY_USER_ID","MessageList","options","defaultOption","option","setOption","speakerDict","Map","set","loading","setLoading","messages","setMessages","author","get","message","timestamp","Date","getTime","messagesEndRef","current","scrollIntoView","behavior","addMyMessage","value","newMessage","previous","withMine","response","getAIResponse","responseMessage","e","console","log","getMessages"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport Compose from \"../Compose\";\nimport Message from \"../Message\";\nimport moment from \"moment\";\n\nimport \"./MessageList.css\";\nimport Toolbar from \"../Toolbar\";\nimport GPTService from \"../../services/gpt\";\nimport MessageBuilderService from \"../../services/message-builder\";\nimport TypingIndicator from \"../TypingIndicator\";\n\nimport Dropdown from 'react-dropdown';\nimport 'react-dropdown/style.css';\n\nconst MY_USER_ID = \"Patient\";\n\nexport interface Message {\n  author: string;\n  message: string;\n  timestamp: number;\n}\nexport default function MessageList() {\n\n  const options = [\n    'Intellectual Conversation',\n    'Theraputic Conversation',\n    'Reflective Conversation',\n    'Problem-solving Conversation',\n    'Open-ended Conversation'\n  ];\n  const defaultOption = options[0];\n  const [option, setOption] = useState(defaultOption);\n\n  // const conversationDict = [\n  //   {id: \"Intellectual Conversation\", character: \"Professor\"},\n  //   {id: \"Theraputic Conversation\", character: \"Therapist\"},\n  //   {id: \"Reflective Conversation\", character: \"Self\"},\n  //   {id: \"Problem-solving Conversation\", character: \"Counselor\"},\n  //   {id: \"Open-ended Conversation\", character: \"Friend\"},\n  // ]\n    type Thing = { data: any };\n    let speakerDict = new Map<string, [string, string]>();\n    speakerDict.set(\"Intellectual Conversation\", [\"Professor\", \"Professor1\"]);\n    speakerDict.set(\"Theraputic Conversation\", [\"Therapist\", \"Therapist1\"]);\n    speakerDict.set(\"Reflective Conversation\", [\"Self\", \"Self1\"]);\n    speakerDict.set(\"Problem-solving Conversation\", [\"Counselor\", \"Counselor1\"]);\n    speakerDict.set(\"Open-ended Conversation\", [\"Friend\", \"Friend1\"]);\n\n\n\n  const [loading, setLoading] = useState(false);\n  const [messages, setMessages] = useState([\n    {\n      author: speakerDict.get(option)[0],\n      message:\n        \"Hi friend! I'm your virtual therapist. How are you feeling today?\",\n      timestamp: new Date().getTime(),\n    },\n  ] as Message[]);\n\n  // Stays scrolled to bottom.\n  const messagesEndRef = useRef(null);\n  useEffect(() => {\n    if (messagesEndRef) {\n      (messagesEndRef.current as any)?.scrollIntoView({ behavior: \"smooth\" })\n    }\n  });\n  const addMyMessage = async (value: string) => {\n    const newMessage = {\n      author: MY_USER_ID,\n      message: value,\n      timestamp: new Date().getTime(),\n    };\n    \n    setMessages((previous) => [...previous, newMessage]);\n    setLoading(true);\n    const withMine = [...messages, newMessage];\n    const response = await GPTService.getAIResponse(withMine);\n    const responseMessage = {\n      author: \"Therapist\",\n      message: response,\n      timestamp: new Date().getTime(),\n    };\n    setMessages((previous) => [...previous, responseMessage]);\n    setLoading(false);\n  };\n\n  return (\n    <div className=\"message-list\">\n      <Toolbar title=\"Chat with GPT3\" />\n      {/* <Dropdown title=\"Select conversatio type\" /> */}\n      <h4>What kind of conversation do you want to have?</h4>\n      <Dropdown options={options} onChange={(e) => {setOption(e.value); console.log(option)}} value={defaultOption} placeholder=\"Select conversation type\" />\n\n      <div className=\"message-list-container\">{MessageBuilderService.getMessages(messages, MY_USER_ID)}\n      {loading && <TypingIndicator />}\n      <div ref={messagesEndRef} />\n      </div>\n      \n\n      <Compose addMessage={addMyMessage} />\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}